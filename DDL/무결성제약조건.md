# 무결성제약조건

## 1. 컬럼의 속성
    1. not null : 널값이 입력되지 못하게 하는 조건
    1. unique : 중복된 값이 입력되지 못하게 하는 조건
    1. primary key : not null + unique 2개를 모두 가지고 있고, 데이터를 식별할수 있는 키
    1. foreign key : 다른 테이블의 필드(컬럼)을 참조해서 무결성을 검사하는 조건
        - 참조키 : 자식에서 참조할 키(부모테이블에서 존재하는 것)
        - 외래키 : 부모에서 참조하고 있는 키(자식테이블에서 존재하는 것)
    1. check : 주어진값만 허용하는 조건

## 2. CREATE시에 제약조건 걸기

## 2-1. 인라인방식

인라인방식은 개별 컬럼뒤에 바로 적용하는 방법입니다. 인라인방식으로 작성시에는 제약조건의 이름은 오라클에서 자동으로 작성합니다. NOT NULL인 경우에는 오직 인라인 방식으로만 사용가능합니다.

### 사용방법

```
CREATE TABLE 테이블명
(
    컬럼명 타입 제약조건,
    컬럼명 타입 제약조건1 제약조건2
)
```

### 사용예제

```
CREATE TABLE CONSTRAINTS_TABLE
(
    no number(10) NOT NULL,
    name varchar2(20) NOT NULL UNIQUE,
    id varchar2(20) PRIMARY KEY    
);
```

## 2-2. 아웃라인방식

아웃라인 방식은 CONSTRAINTS키워드를 이용하여 제약조건을 줄수있습니다. 이때 제약조건에 이름을 직접 줄수있습니다.

### 사용방법

**[]안에 내용은 생략가능**

```
CREATE TABLE 테이블명
(
    컬럼명1 타입,
    컬럼명2 타입,
    CONSTARINTS [조건이름] 제약조건(컬럼명1, 컬럼명2)
)
```

### 사용예제

```
CREATE TABLE CONSTRAINTS_OUTLINE_TABLE
(
    no number(10) NOT NULL,
    name varchar2(20) NOT NULL,
    id varchar(20),
    CONSTARINTS TABLE_UNIQUE UNIQUE(name),
    CONSTARINTS TABLE_PK PRIMARY KEY(id)
);
```

## 3. ALTER로 제약조건 걸기

## 3-1. 제약조건 추가

### 사용방법

**[]안에 내용은 생략가능**

```
ALTER TABLE 테이블명 add [CONSTARINTS] 기본키이름] 제약조건(필드명)
ALTER TABLE 테이블명 modify 컬럼명 NOT NULL
```

### 사용예제

```
ALTER TABLE CONSTRAINTS_OUTLINE_TABLE add (NEW_COLUMN varchar2(20));    -- 컬럼 NEW_COLUMN 추가
ALTER TABLE CONSTRAINTS_OUTLINE_TABLE add UNIQUE(NEW_COLUMN);   -- 새로 생성한 NEW_COLUMN에 UNIQUE제약조건 추가
ALTER TABLE CONSTRAINTS_OUTLINE_TABLE modify NEW_COLUMN NOT NULL;    -- NOT NULL은 컬럼 수정으로 가능

ALTER TABLE CONSTRAINTS_OUTLINE_TABLE add (NEW_COLUMN1 varchar2(20) NOT NULL);    -- 컬럼 NEW_COLUMN1 추가하면서 NOT NULL 가능
ALTER TABLE CONSTRAINTS_OUTLINE_TABLE add CONSTRAINTS TABLE_UNIQUE UNIQUE(NEW_COLUMN1);  -- 제약조건에 이름을 직접 작성가능 
```

## 3-2. 제약조건 삭제

### 사용방법 

```
ALTER TABLE 테이블명 drop CONSTRAINT 제약조건명
```

### 사용예제

```
ALTER TABLE CONSTRAINTS_OUTLINE_TABLE drop CONSTRAINT TABLE_UNIQUE; -- 해당 제약조건 삭제
ALTER TABLE CONSTRAINTS_OUTLINE_TABLE drop PRIMARY KEY; -- PRIMARY KEY의 경우 이름없이 해당방법으로 삭제 가능
```

## 4. FOREIGN KEY

1. FK가 정의 된 테이블이 자식테이블입니다.
1. 참조되는 테이블이 부모테이블입니다.
1. 부모테이블은 FK로 인해 삭제될수 없습니다.
1. 참조되는 컬럼은 PK이거나 UNIQUE이어야 합니다.

## 4-1. CREATE시에 인라인 방식

### 사용방법 

**[]안에 내용은 생략가능**

```
CREATE TABLE 테이블명
(
    컬럼명 [타입] [CONSTRAINTS 제약조건이름] REFERENCES 부모테이블(참조키)
)
```

### 사용예제

```
--- 부모테이블
CREATE TABLE PARENT_TABLE
(
    no number(10) PRIMARY KEY       -- 부모의 참조키는 UNIQUE이거나 PRIMARY KEY를 가져야 합니다.
);

--- 자식테이블(FK를 선언한 테이블이 자식테이블입니다.)
CREATE TABLE CHILD_TABLE
(
    no CONSTRAINTS TABLE_FK REFERENCES PARENT_TABLE(no) -- 컬럼의 타입도 생략 가능합니다.
);
```

## 4-2. CREATE시에 아웃라인 방식

### 사용방법 

```
CREATE TABLE 테이블명
(
    컬럼명 타입,
    CONSTRAINTS 제약조건이름 FOREIGN KEY(컬럼) REFERENCES 부모테이블(참조키) 
)
```

### 사용예제

```
CREATE TABLE PARENT_TABLE1
(
    no number(10) PRIMARY KEY       
);

CREATE TABLE CHILD_TABLE1
(
    no number(10),
    CONSTRAINTS TABLE_FK FOREIGN KEY(no) REFERENCES PARENT_TABLE1(no)
);
```

## 4-3. ALTER를 이용하여 외래키 추가

### 사용방법

```
ALTER TABLE 테이블명 CONSTRAINTS 제약조건명 FOREIGN KEY(컬럼명) REFERENCES 부모테이블(참조키)
```

## 5. CHECK

## 5-1. CREATE시에 아웃라인으로 추가

### 사용예제

```
CREATE TABLE 테이블명
(
    컬럼명 타입,
    CONSTRAINTS 제약조건명 CHECK(컬럼명 IN(값1, 값2..))
)
```

### 사용방법

```
CREATE TABLE CHECK_TABLE
(
    no number(10),
    CONSTRAINTS TABLE_CHECK CHECK(no IN(1, 2))
);

INSERT INTO CHECK_TABLE VALUES(1);  -- 정상적으로 데이터 삽입
INSERT INTO CHECK_TABLE VALUES(3);  -- CHECK 제약조건으로 인하여 오류 발생
```

```
CREATE TABLE CHECK_TABLE
(
    no number(10),
    CONSTRAINTS TABLE_CHECK CHECK(no BETWEEN 500 AND 5000)  -- 500에서 5000까지 입력가능
);
```