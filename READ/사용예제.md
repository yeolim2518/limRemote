# 3. 사용예제

## 3-1. 파일저장기능 활용(나머지는 default)

```java
public void excelUpload(MultipartHttpServletRequest mRequest, String uploadPath, String uploadName) {
    
    // ReadOption 객체 생성
    ReadOption readOption = new ReadOption();
    
    // 파일저장을 ReadOption에서 처리
    readOption.setFilePath(mRequest, uploadPath, uploadName);	// setFilePath은 가장 기본적인 옵션
    
    List<Object> list = ExcelRead.read(readOption);
}
```

## 3-2 특정 컬럼의 값만 가져오기
```java
public void excelUpload(File file) {

    // ReadOption 객체 생성하면서 특정 컬럼(A, C)의 값만 받아온다는 설정 추가
    ReadOption readOption = new ReadOption("A", "C");
    
    // file에 저장되어있는 엑셀파일을 가져올것이라고 설정
    readOption.setFilePath(file);
    
    List<Object> list = ExcelRead.read(readOption);
}
```

## 3-3 반환결과를 Map으로 받기
```java
public void excelUpload(File file) {
    ReadOption readOption = new ReadOption();
    
    readOption.setFilePath(file);
    
    // ExcelRead.excelObjectToMap 메서드를 사용하여 반환타입을 List<Map<String, Object>>로 저장
    List<Map<String, Object>> list = ExcelRead.excelObjectToMap(ExcelRead.read(readOption));
}
```

## 3-4 반환결과를 VO로 받기
```java
public void excelUpload(File file) {
    ReadOption readOption = new ReadOption();
   
    readOption.setFilePath(file);
    readOption.setTitleCheck(true);								// VO를 사용 할 때는 필수 옵션
    readOption.setExcelVO(ExcelVO.class);						// VO를 사용 할 때 해당하는 VO.class 입력
    
    // getExcelVOList메서드를 통해서 List<Object>가 아닌 List<ExcelVO>로 반환
    List<ExcelVO> list = getExcelVOList(ExcelRead.read(readOption));
}

// 해당 코드는 수동 작성 필요
private List<ExcelVO> getExcelVOList(List<Object> list) {
    List<ExcelVO> excelList = new ArrayList<>();
    
    for (int i = 0, length = list.size(); i < length; i++) {
        excelList.add((ExcelVO) list.get(i));
    }
    
    return excelList;
}
```

#### [README로 돌아가기](README.md)
